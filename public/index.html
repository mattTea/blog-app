<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<title>the t-shaped BA</title>
	</head>

	<body>
	<h1>the tea-shaped business analyst</h1>
	<p>chatting about my experiences whilst learning to code. and still trying to be a business analyst.</p>

	<h2>the blogs...</h2>
	
	<input id="blog-search-box" type="text" placeholder="Search titles & authors"/>
	<button id="search-button">Search</button>
	
	<div id="blogs"><!--articles to be served here --></div>

    <div id="blog-title"></div>

    <div id="blog-author"></div>

    <div id="blog-content"></div>


	</body>

	<script>
    //when page has fully rendered then execute this code
    $(document).ready(function () {

        $("#search-button").click(function (element) {
            
            //get blogs from input box
            var articleHeadlineSearch = $("#blog-search-box").val().toLowerCase();
            console.log('articleHeadlineSearch:', articleHeadlineSearch);

            //query backend api and render the result
            var apiSearch = "https://api.cosmicjs.com/v1/matttea-blog-app/object-type/articles/search?metafield_key=search&metafield_value_has=" + articleHeadlineSearch;
            console.log('querying api...');
            
            $.get(apiSearch, function (data) {
                //possibly a for loop in here?
            	var title = JSON.stringify(data.objects[0].title);
                var author = JSON.stringify(data.objects[0].metadata.author.title);
                var content = JSON.stringify(data.objects[0].content);

            	$("#blogs").html("<br>" + title + "<br>" + "<br>" + author + "<br>" + content);
                console.log('query finished, got', data);
            });
    	});
    });

    //TODO - show all blogs as standard and change search to filter
    //TODO - ability to return multiple search results (just [0] at present)
    //TODO - html divs and style sheet to show JSON property values differently (Title, Author, etc)
    //TODO - Add elements to display author pic and details

    </script>
</html>

<!-- set up divs so that we have...
div for blog title
div for blog author
div for blog content

hopefully these div types or whatever they are can be set up as common components
then need to repeat for n blogs -->