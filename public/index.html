<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<title>the t-shaped BA</title>
	</head>

	<body>
	<h1>the tea-shaped business analyst</h1>
	<p>chatting about my experiences whilst learning to code. and still trying to be a business analyst.</p>

	<h2>the blogs...</h2>
	
	<input id="blog-search-box" type="text" placeholder="Search blog titles"/>
	<button id="search-button">Search</button>
	
	<div id="blogs"><!--articles to be served here -->
		
	</div>

	</body>

	<script>
    //when page has fully rendered then execute this code
    $(document).ready(function () {

        $("#search-button").click(function (element) {
            //get blogs from input box
            $("#blogs").empty(); // added to clear previous result
            
            var articleHeadlineSearch = $("#blog-search-box").val();
            console.log('articleHeadlineSearch:', articleHeadlineSearch);

            //query backend api and render the result
            // var apiSearch = "https://api.cosmicjs.com/v1/matttea-blog-app/object-type/articles/search?metafield_key=headline&metafield_value_has=" + articleHeadlineSearch; //allows search string, but not object.content properties
            var apiSearch = "https://api.cosmicjs.com/v1/matttea-blog-app/object/" + articleHeadlineSearch; //requires part-1-a-taster (slug) format         
            console.log('querying api...');
            $.get(apiSearch, function (data) {
            	// $("#blogs").html(JSON.stringify(data));
            	$("#blogs").html(JSON.stringify(data.object.title + data.object.metadata.author.title + data.object.content));
            	// $("#blogs").html(JSON.stringify(data.object.content));
            	console.log('query finished, got', data);
            });
    	});
    });

    //TODO - return only specific fields, e.g Headline, Author, Hero image, Date created, Body
    //TODO - Add elements to display author details

    </script>
</html>

